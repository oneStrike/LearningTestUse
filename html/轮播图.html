<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="../css/reset.min.css">
    <link rel="stylesheet" href="../css/轮播图.css">
    <script src="../jQuery/node_modules/jquery/dist/jquery.js"></script>
</head>

<body>
    <section class="container" id="container">
        <div class="wrapper">
            <!-- <div class="slide"><img src="../images/1.png" alt=""></div>
        <div class="slide"><img src="../images/2.png" alt=""></div>
        <div class="slide"><img src="../images/3.png" alt=""></div>
        <div class="slide"><img src="../images/4.png" alt=""></div> -->
        </div>
        <ul class="focus">
            <!-- <li class="active"></li> -->
            <!-- <li></li>
        <li></li>
        <li></li> -->
        </ul>
        <a href="javascript:;" class="arrow arrowLeft"></a>
        <a href="javascript:;" class="arrow arrowRight"></a>
    </section>
    <script src="../js/animate.js"></script>
    <!-- <script src="../jQuery/jquery1.11.3/dist/jquery.js"></script> -->
    <!-- <script src="../js/轮播图.js"></script> -->
    <script>
        let banner = (function () {
            let container = document.getElementById('container'),
                wrapper = container.querySelector('.wrapper'),
                focus = container.querySelector('.focus'),
                arrowLeft = container.querySelector('.arrowLeft'),
                arrowRight = container.querySelector('.arrowRight'),
                showImg = null,
                focusList = null,
                imgW = null,
                imgL = null,
                imgData = null,
                autoTimer = null,
                speed = 300,
                interval = 3000,
                index = 0,
                target = null,
                time = 0;
            //获取数据
            let queryData = function () {
                let xhr = new XMLHttpRequest();
                xhr.open('get', '../json/banner.json', false);
                xhr.onreadystatechange = function () {
                    if (xhr.readyState === 4 && xhr.status === 200) {
                        imgData = window.JSON.parse(xhr.responseText);
                    }
                };
                xhr.send(null);
            }

            //绑定数据
            let bindHTML = function () {
                let imgStr = ``,
                    focusStr = ``;
                imgData.forEach(function (item, index) {
                    imgStr += `<div class="slide"><img src="${item.img}" alt=""></div>`;
                    focusStr += `<li class="${index===0?"active":""}"></li>`;
                });
                wrapper.innerHTML = imgStr;
                focus.innerHTML = focusStr;
                showImg = wrapper.querySelectorAll('.slide');
                focusList = focus.querySelectorAll('li');
                wrapper.appendChild(showImg[0].cloneNode(true));
                showImg = wrapper.querySelectorAll('.slide');
                imgW = parseFloat(getComputedStyle(showImg[0]).width);
                imgH = parseFloat(getComputedStyle(showImg[0]).height);
                wrapper.style.width = imgW * showImg.length + 'px';
            };

            //设置轮播
            let autoMove = function () {
                autoTimer = setInterval(function () {
                    index++;
                    if (index == showImg.length) {
                        index = 1;
                        wrapper.style.left = 0 + 'px';
                    };

                    clearInterval(wrapper.timer);
                    let begin = parseFloat(window.getComputedStyle(wrapper).left);
                    change = -index * imgW;
                    time = 0;

                }, interval);
            };

            return {
                init: function () {
                    queryData();
                    bindHTML();
                    autoMove();
                }
            }
        })();
        banner.init();
    </script>
</body>

</html>